<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>フォント変換ツール｜かわいい文字に変身 ✨</title>
  <meta name="description" content="アルファベットをかわいい見た目の文字に変換するシングルページアプリ。コピペしてSNSで使えます。" />
  <style>
    /* ===== Design Tokens ===== */
    :root {
      --bg: #0b0f19;
      --fg: #e9ecf1;
      --muted: #b7c0d5;
      --panel: rgba(255,255,255,0.06);
      --panel-border: rgba(255,255,255,0.12);
      --accent-1: #7c9aff;  /* periwinkle */
      --accent-2: #ff8ad6;  /* pink */
      --accent-3: #70ffd2;  /* mint */
      --radius: 18px;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
    }
    @media (prefers-color-scheme: light) {
      :root { --bg: #f7f8fd; --fg: #11131a; --muted: #5b6273; --panel: rgba(255,255,255,0.8); --panel-border: rgba(0,0,0,0.08); }
      .bg-grid::before{opacity:.35}
    }

    /* ===== Base ===== */
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: ui-sans-serif, system-ui, "Segoe UI", "Helvetica Neue", Arial, "Hiragino Kaku Gothic ProN", Meiryo, "Noto Sans JP", sans-serif;
      color: var(--fg);
      background: radial-gradient(1200px 800px at 20% 10%, rgba(124,154,255,.18), transparent 60%),
                  radial-gradient(1000px 700px at 80% 20%, rgba(255,138,214,.18), transparent 60%),
                  radial-gradient(900px 600px at 50% 100%, rgba(112,255,210,.14), transparent 60%), var(--bg);
      letter-spacing: .02em;
    }
    .bg-grid{
      position: fixed; inset: 0; pointer-events:none;
    }
    .bg-grid::before{
      content:""; position:absolute; inset:0; background:linear-gradient(transparent 95%, rgba(255,255,255,.08) 95%), linear-gradient(90deg, transparent 95%, rgba(255,255,255,.08) 95%);
      background-size: 40px 40px; opacity:.18; mask-image: radial-gradient(70% 70% at 50% 30%, black, transparent);
    }

    .container { max-width: 1100px; margin: 40px auto; padding: 20px; }

    /* ===== Card / Panel ===== */
    .card {
      background: var(--panel);
      border: 1px solid var(--panel-border);
      border-radius: var(--radius);
      backdrop-filter: blur(12px);
      box-shadow: var(--shadow);
    }
    .header {
      display:flex; align-items:center; gap:16px; padding: 18px 22px;
    }
    .logo { width: 44px; height:44px; border-radius: 50%; background: conic-gradient(from 210deg, var(--accent-1), var(--accent-2), var(--accent-3), var(--accent-1)); box-shadow: inset 0 0 0 5px rgba(255,255,255,.15); display:grid; place-items:center; }
    .logo span { font-size: 20px; }
    .title { font-weight: 800; font-size: clamp(20px, 3vw, 28px); letter-spacing: .02em; }
    .subtitle { color: var(--muted); font-size: 13px; }

    /* ===== Layout ===== */
    .grid { display:grid; grid-template-columns: 1.1fr .9fr; gap: 18px; }
    @media (max-width: 980px){ .grid{ grid-template-columns: 1fr; } }

    /* ===== Inputs ===== */
    .section { padding: 18px 22px; }
    .label-row { display:flex; justify-content: space-between; align-items: center; gap: 12px; margin-bottom: 8px; }
    .label-row h3{ margin:0; font-size: 14px; font-weight:700; letter-spacing:.02em; }
    .hint { color: var(--muted); font-size: 12px; }

    textarea, input[type="text"] { width:100%; box-sizing:border-box; background: rgba(255,255,255,.06); color: var(--fg); border:1px solid var(--panel-border); border-radius: 14px; padding:14px 14px; font-size: 16px; outline: none; transition: border-color .2s, box-shadow .2s; }
    textarea:focus, input:focus { border-color: color-mix(in oklab, var(--accent-1) 50%, white); box-shadow: 0 0 0 6px rgba(124,154,255,.15); }
    textarea { min-height: 120px; resize: vertical; }

    .controls { display:flex; flex-wrap:wrap; gap: 10px; }
    .select, .chip, .btn { display:inline-flex; align-items:center; gap:8px; border-radius: 14px; border:1px solid var(--panel-border); background: rgba(255,255,255,.06); padding:10px 12px; font-size: 14px; cursor: pointer; user-select:none; transition: transform .05s ease, background .2s, border-color .2s; }
    .chip:hover, .btn:hover, .select:hover { background: rgba(255,255,255,.12); }
    .btn:active { transform: translateY(1px) scale(.99); }
    .btn.primary { background: linear-gradient(135deg, color-mix(in oklab, var(--accent-1) 82%, white), color-mix(in oklab, var(--accent-2) 82%, white)); border: none; color: #111; font-weight: 800; box-shadow: 0 6px 16px rgba(124,154,255,.25); }

    select { appearance:none; background: transparent; color: inherit; border: none; font: inherit; outline: none; }

    /* ===== Style cards ===== */
    .styles { display:grid; grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); gap: 14px; }
    .style-card { position:relative; padding: 14px; border-radius: 16px; border:1px solid var(--panel-border); background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04)); min-height: 120px; display:flex; flex-direction:column; gap:10px; }
    .style-head { display:flex; align-items:center; justify-content: space-between; gap:8px; }
    .style-name { font-weight: 700; font-size: 14px; }
    .style-desc { color: var(--muted); font-size: 12px; }
    .out { font-size: clamp(18px, 2.2vw, 22px); line-height: 1.35; word-break: break-word; }
    .card-actions { display:flex; gap:8px; }

    .toast { position: fixed; left: 50%; bottom: 16px; transform: translateX(-50%) translateY(20px); opacity: 0; background: #111; color: #fff; padding: 10px 14px; border-radius: 999px; box-shadow: var(--shadow); transition: .25s ease; z-index: 99; }
    .toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }

    /* Footer / Help */
    details.help { margin-top: 18px; }
    details.help summary { list-style: none; cursor: pointer; }
    details.help summary::-webkit-details-marker{ display:none; }
    details.help .helpbox { margin-top: 10px; padding: 14px; border-radius: 14px; border:1px dashed var(--panel-border); background: rgba(255,255,255,.04);
      font-size: 14px; color: var(--muted); }
    .kbd{ font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; background: rgba(255,255,255,.08); border:1px solid var(--panel-border); padding:.2em .45em; border-radius:8px; }

    .footer { text-align:center; color: var(--muted); font-size: 12px; padding: 20px 8px; }
  </style>
</head>
<body>
  <div class="bg-grid" aria-hidden="true"></div>
  <div class="container">
    <div class="card header">
      <div class="logo" aria-hidden="true"><span>✧</span></div>
      <div>
        <div class="title">フォント変換ツール</div>
        <div class="subtitle">アルファベットを “かわいい見た目の文字” に一瞬で変換してコピペ ✨</div>
      </div>
      <div style="margin-left:auto; display:flex; gap:8px; align-items:center;">
        <button class="btn" id="themeBtn" title="テーマ切替 (Light/Dark)">🌗 テーマ</button>
        <button class="btn" id="shareBtn" title="URLを共有">🔗 共有</button>
        <button class="btn primary" id="copyAllBtn" title="表示中の結果をまとめてコピー">一括コピー</button>
      </div>
    </div>

    <div class="grid">
      <!-- Left: Input & Options -->
      <div class="card section">
        <div class="label-row">
          <h3>入力テキスト</h3>
          <div class="hint">英字（A〜Z / a〜z）と数字がかわいくなります。ひらがな等はそのまま。</div>
        </div>
        <textarea id="input" placeholder="例）Hello from shimarin"></textarea>

        <div style="height:10px"></div>

        <div class="label-row">
          <h3>オプション</h3>
          <div class="hint">見た目や仕上げを調整できます</div>
        </div>
        <div class="controls" role="group" aria-label="変換オプション">
          <div class="select">
            <span>🔤 大文字/小文字</span>
            <select id="caseSelect" aria-label="大文字小文字の選択">
              <option value="keep">そのまま</option>
              <option value="upper">すべて大文字</option>
              <option value="lower">すべて小文字</option>
            </select>
          </div>
          <div class="select">
            <span>✨ デコ</span>
            <select id="decoSelect" aria-label="デコレーション種類">
              <option value="none">なし</option>
              <option value="heart">ハート ♡</option>
              <option value="sparkle">きらきら ✨</option>
              <option value="star">スタ― ★</option>
              <option value="ribbon">リボン 🎀</option>
            </select>
          </div>
          <div class="select">
            <span>配置</span>
            <select id="decoMode" aria-label="デコレーション配置">
              <option value="edge">両はし</option>
              <option value="between">文字の間</option>
            </select>
          </div>
          <button class="btn" id="shuffleBtn" title="サンプル文を入れる">🎲 サンプル</button>
          <button class="btn" id="clearBtn" title="入力を空にする">🧹 クリア</button>
        </div>
      </div>

      <!-- Right: Result list -->
      <div class="card section">
        <div class="label-row">
          <h3>変換結果（タップでコピー）</h3>
          <div class="hint">端末によっては見た目が少し変わることがあります</div>
        </div>
        <div id="styles" class="styles" aria-live="polite"></div>

        <details class="help">
          <summary class="chip">📝 使い方・ヒント（クリックで開く）</summary>
          <div class="helpbox">
            <p>1) 上で文字を入力 → 2) 下に表示されたスタイルをタップしてコピー → 3) SNSやプロフィールに貼り付け！</p>
            <p>英字は <span class="kbd">Unicode</span> とよばれる番号で表されており、番号の違う “見た目ちがいの仲間” に差し替える仕組みです。文字そのものなので、画像ではなくコピペで使えます。</p>
            <ul>
              <li>コピーに成功すると、画面下にトーストが出ます。</li>
              <li>コピーに失敗した場合は、結果テキストが<strong>自動で選択状態</strong>になります。<span class="kbd">Ctrl + C</span> / <span class="kbd">Cmd + C</span> でコピーしてください（スマホは長押し→コピー）。</li>
              <li>ブラウザは <span class="kbd">https://</span> か <span class="kbd">http://localhost</span> で開くと安定します（VS Code の <span class="kbd">Live Server</span> 推奨）。</li>
              <li>共有ボタンで、今のテキストを含むURLを作れます。</li>
              <li>スマホで見た目が変わる時は、フォントの対応状況が原因のことがあります。</li>
            </ul>
          </div>
        </details>
      </div>
    </div>

    <div class="footer">© 2025 Font Cute – 文字は変身しても心はそのまま (•ᴗ•)و</div>
  </div>

  <div id="toast" class="toast" role="status" aria-live="polite">コピーしました</div>

  <script>
    // ========= Utilities =========
    const $ = (sel) => document.querySelector(sel);
    const inputEl = $('#input');
    const stylesEl = $('#styles');
    const toastEl = $('#toast');

    // ===== Copy helpers (secure + fallback) =====
    function safeCopyText(text){
      if (navigator.clipboard && window.isSecureContext){
        return navigator.clipboard.writeText(text);
      } else {
        try {
          const ta = document.createElement('textarea');
          ta.value = text; ta.setAttribute('readonly','');
          ta.style.position='fixed'; ta.style.top='-9999px';
          document.body.appendChild(ta); ta.select(); ta.setSelectionRange(0, ta.value.length);
          const ok = document.execCommand('copy');
          document.body.removeChild(ta);
          return ok ? Promise.resolve() : Promise.reject();
        } catch(e){ return Promise.reject(e); }
      }
    }
    function selectElementForCopy(el){
      try {
        const range = document.createRange(); range.selectNodeContents(el);
        const sel = window.getSelection(); sel.removeAllRanges(); sel.addRange(range);
      } catch(e){}
    }

    function showToast(msg = 'コピーしました'){
      toastEl.textContent = msg;
      toastEl.classList.add('show');
      setTimeout(() => toastEl.classList.remove('show'), 1200);
    }

    // Persist theme
    const prefersLight = window.matchMedia('(prefers-color-scheme: light)').matches;
    let theme = localStorage.getItem('theme') || (prefersLight ? 'light' : 'dark');
    function applyTheme(){ document.documentElement.style.colorScheme = theme; }
    applyTheme();
    $('#themeBtn').addEventListener('click', () => { theme = (theme === 'light') ? 'dark' : 'light'; localStorage.setItem('theme', theme); applyTheme(); });

    // ========= Text helpers =========
    const A = 'A'.charCodeAt(0), Z = 'Z'.charCodeAt(0);
    const a = 'a'.charCodeAt(0), z = 'z'.charCodeAt(0);
    const d0 = '0'.charCodeAt(0), d9 = '9'.charCodeAt(0);

    const circledDigits = {
      '0': '\u24EA', // ⓪
      '1': '\u2460','2': '\u2461','3': '\u2462','4': '\u2463','5': '\u2464','6': '\u2465','7': '\u2466','8': '\u2467','9': '\u2468'
    };

    function mapAlphaNum(ch, bases){
      const code = ch.codePointAt(0);
      if (code >= A && code <= Z && bases.upper != null) return String.fromCodePoint(bases.upper + (code - A));
      if (code >= a && code <= z && bases.lower != null) return String.fromCodePoint(bases.lower + (code - a));
      if (code >= d0 && code <= d9 && bases.digit != null) return String.fromCodePoint(bases.digit + (code - d0));
      if (bases.circledDigit && circledDigits[ch]) return circledDigits[ch];
      return ch; // keep as is
    }

    function mapString(str, bases){
      let out = '';
      for (const ch of str){ out += mapAlphaNum(ch, bases); }
      return out;
    }

    // ========= Style Definitions =========
    const STYLES = [
      {
        id: 'bubble',
        name: 'まる文字 (Bubble)',
        desc: 'まるでステッカーのような囲み文字',
        transform: (s)=> mapString(s, { upper: 0x24B6, lower: 0x24D0, circledDigit: true })
      },
      {
        id: 'boldScript',
        name: 'ふわ文字 (Bold Script)',
        desc: '手書き風でやわらか',
        transform: (s)=> mapString(s, { upper: 0x1D4D0, lower: 0x1D4EA })
      },
      {
        id: 'bold',
        name: 'つよかわ (Bold)',
        desc: '太めで存在感',
        transform: (s)=> mapString(s, { upper: 0x1D400, lower: 0x1D41A, digit: 0x1D7CE })
      },
      {
        id: 'double',
        name: 'きらめき (Double-struck)',
        desc: '黒板チョーク風の二重線',
        transform: (s)=> mapString(s, { upper: 0x1D538, lower: 0x1D552, digit: 0x1D7D8 })
      },
      {
        id: 'sans',
        name: 'スッキリ (Sans-serif)',
        desc: 'やさしいサンセリフ',
        transform: (s)=> mapString(s, { upper: 0x1D5A0, lower: 0x1D5BA, digit: 0x1D7E2 })
      },
      {
        id: 'mono',
        name: 'カチッ (Monospace)',
        desc: '等幅でレトロかわいい',
        transform: (s)=> mapString(s, { upper: 0x1D670, lower: 0x1D68A, digit: 0x1D7F6 })
      },
      {
        id: 'fraktur',
        name: 'ゴシかわ (Fraktur)',
        desc: 'クラシックな雰囲気',
        transform: (s)=> mapString(s, { upper: 0x1D504, lower: 0x1D51E })
      },
      {
        id: 'fullwidth',
        name: 'ふとまる (全角)',
        desc: '全角でポップ',
        transform: (s)=> mapString(s, { upper: 0xFF21, lower: 0xFF41, digit: 0xFF10 })
      }
    ];

    const DECOS = { none: '', heart: '♡', sparkle: '✨', star: '★', ribbon: '🎀' };

    function applyDeco(text, deco, mode){
      const d = DECOS[deco] || '';
      if (!d) return text;
      if (mode === 'between'){
        // Insert between letters but keep spaces/newlines as is
        let out = '';
        for (let i=0; i<text.length; i++){
          const ch = text[i];
          out += ch;
          const next = text[i+1];
          if (next && ch !== '\n' && next !== '\n' && ch !== ' ' && next !== ' '){ out += d; }
        }
        return out;
      }
      return `${d} ${text} ${d}`;
    }

    function normalizeCase(text, mode){
      if (mode === 'upper') return text.toUpperCase();
      if (mode === 'lower') return text.toLowerCase();
      return text;
    }

    function render(){
      const raw = inputEl.value || '';
      const cMode = $('#caseSelect').value;
      const deco = $('#decoSelect').value;
      const decoMode = $('#decoMode').value;
      const src = normalizeCase(raw, cMode);
      stylesEl.innerHTML = '';
      STYLES.forEach(style => {
        let t = style.transform(src);
        t = applyDeco(t, deco, decoMode);
        const card = document.createElement('div'); card.className = 'style-card';
        card.innerHTML = `
          <div class="style-head">
            <div>
              <div class="style-name">${style.name}</div>
              <div class="style-desc">${style.desc}</div>
            </div>
            <div class="card-actions">
              <button class="btn" data-copy>📋 コピー</button>
            </div>
          </div>
          <div class="out" data-out>${t || '<span style="color:var(--muted)">（ここに結果が表示されます）</span>'}</div>
        `;
        card.addEventListener('click', (e)=>{
          if (e.target.matches('[data-copy]') || e.target.closest('[data-out]')){
            const txt = card.querySelector('[data-out]').innerText;
            safeCopyText(txt).then(()=> showToast('コピーしました')).catch(()=> { selectElementForCopy(card.querySelector('[data-out]')); showToast('選択しました。Ctrl/Cmd+C でコピー'); });
          }
        });
        stylesEl.appendChild(card);
      });
      // update share URL (shallow)
      const url = new URL(location);
      if (raw) url.searchParams.set('text', raw); else url.searchParams.delete('text');
      history.replaceState({}, '', url);
      localStorage.setItem('fontcute:last', raw);
    }

    // Debounce input
    let tId; inputEl.addEventListener('input', ()=>{ clearTimeout(tId); tId = setTimeout(render, 10); });

    // Buttons
    $('#clearBtn').addEventListener('click', ()=>{ inputEl.value=''; render(); inputEl.focus(); });
    $('#shuffleBtn').addEventListener('click', ()=>{
      const samples = [
        'Hello from shimarin', 'Cutest Letters', 'Kawaii Vibes', 'Coffee & Coding', 'Stay comfy, stay kind', 'Dream big, start small', 'Cute text generator', 'Follow your color', 'Happy Friday!', 'Love & peace'
      ];
      inputEl.value = samples[Math.floor(Math.random()*samples.length)];
      render();
    });
    $('#copyAllBtn').addEventListener('click', ()=>{
      const outs = [...document.querySelectorAll('[data-out]')].map(e=> e.innerText).filter(Boolean);
      const txt = outs.join('\n');
      if (!txt.trim()) return showToast('コピーする内容がありません');
      safeCopyText(txt).then(()=> showToast('全部コピーしました')).catch(()=> { const ta=document.createElement('textarea'); ta.value=txt; document.body.appendChild(ta); ta.select(); showToast('選択しました。Ctrl/Cmd+C でコピー'); setTimeout(()=>{ try{document.body.removeChild(ta);}catch(e){} }, 1200); });
    });

    $('#shareBtn').addEventListener('click', ()=>{
      const url = location.href;
      if (navigator.share){ navigator.share({ title: 'フォント変換ツール', url }).catch(()=>{}); }
      else { safeCopyText(url).then(()=> showToast('URLをコピーしました')).catch(()=> { try{ window.prompt('このURLをコピーしてください', url); }catch(e){} }); }
    });

    // On load: restore from URL or localStorage
    (function init(){
      const params = new URLSearchParams(location.search);
      const text = params.get('text') || localStorage.getItem('fontcute:last') || '';
      inputEl.value = text;
      render();
    })();
  </script>
</body>
</html>
