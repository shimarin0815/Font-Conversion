<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ãƒ•ã‚©ãƒ³ãƒˆå¤‰æ›ãƒ„ãƒ¼ãƒ«ï½œã‹ã‚ã„ã„æ–‡å­—ã«å¤‰èº« âœ¨</title>
  <meta name="description" content="ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆã‚’ã‹ã‚ã„ã„è¦‹ãŸç›®ã®æ–‡å­—ã«å¤‰æ›ã™ã‚‹ã‚·ãƒ³ã‚°ãƒ«ãƒšãƒ¼ã‚¸ã‚¢ãƒ—ãƒªã€‚ã‚³ãƒ”ãƒšã—ã¦SNSã§ä½¿ãˆã¾ã™ã€‚" />
  <style>
    /* ===== Design Tokens ===== */
    :root {
      --bg: #0b0f19;
      --fg: #e9ecf1;
      --muted: #b7c0d5;
      --panel: rgba(255,255,255,0.06);
      --panel-border: rgba(255,255,255,0.12);
      --accent-1: #7c9aff;  /* periwinkle */
      --accent-2: #ff8ad6;  /* pink */
      --accent-3: #70ffd2;  /* mint */
      --radius: 18px;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
    }
    @media (prefers-color-scheme: light) {
      :root { --bg: #f7f8fd; --fg: #11131a; --muted: #5b6273; --panel: rgba(255,255,255,0.8); --panel-border: rgba(0,0,0,0.08); }
      .bg-grid::before{opacity:.35}
    }

    /* ===== Base ===== */
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: ui-sans-serif, system-ui, "Segoe UI", "Helvetica Neue", Arial, "Hiragino Kaku Gothic ProN", Meiryo, "Noto Sans JP", sans-serif;
      color: var(--fg);
      background: radial-gradient(1200px 800px at 20% 10%, rgba(124,154,255,.18), transparent 60%),
                  radial-gradient(1000px 700px at 80% 20%, rgba(255,138,214,.18), transparent 60%),
                  radial-gradient(900px 600px at 50% 100%, rgba(112,255,210,.14), transparent 60%), var(--bg);
      letter-spacing: .02em;
    }
    .bg-grid{
      position: fixed; inset: 0; pointer-events:none;
    }
    .bg-grid::before{
      content:""; position:absolute; inset:0; background:linear-gradient(transparent 95%, rgba(255,255,255,.08) 95%), linear-gradient(90deg, transparent 95%, rgba(255,255,255,.08) 95%);
      background-size: 40px 40px; opacity:.18; mask-image: radial-gradient(70% 70% at 50% 30%, black, transparent);
    }

    .container { max-width: 1100px; margin: 40px auto; padding: 20px; }

    /* ===== Card / Panel ===== */
    .card {
      background: var(--panel);
      border: 1px solid var(--panel-border);
      border-radius: var(--radius);
      backdrop-filter: blur(12px);
      box-shadow: var(--shadow);
    }
    .header {
      display:flex; align-items:center; gap:16px; padding: 18px 22px;
    }
    .logo { width: 44px; height:44px; border-radius: 50%; background: conic-gradient(from 210deg, var(--accent-1), var(--accent-2), var(--accent-3), var(--accent-1)); box-shadow: inset 0 0 0 5px rgba(255,255,255,.15); display:grid; place-items:center; }
    .logo span { font-size: 20px; }
    .title { font-weight: 800; font-size: clamp(20px, 3vw, 28px); letter-spacing: .02em; }
    .subtitle { color: var(--muted); font-size: 13px; }

    /* ===== Layout ===== */
    .grid { display:grid; grid-template-columns: 1.1fr .9fr; gap: 18px; }
    @media (max-width: 980px){ .grid{ grid-template-columns: 1fr; } }

    /* ===== Inputs ===== */
    .section { padding: 18px 22px; }
    .label-row { display:flex; justify-content: space-between; align-items: center; gap: 12px; margin-bottom: 8px; }
    .label-row h3{ margin:0; font-size: 14px; font-weight:700; letter-spacing:.02em; }
    .hint { color: var(--muted); font-size: 12px; }

    textarea, input[type="text"] { width:100%; box-sizing:border-box; background: rgba(255,255,255,.06); color: var(--fg); border:1px solid var(--panel-border); border-radius: 14px; padding:14px 14px; font-size: 16px; outline: none; transition: border-color .2s, box-shadow .2s; }
    textarea:focus, input:focus { border-color: color-mix(in oklab, var(--accent-1) 50%, white); box-shadow: 0 0 0 6px rgba(124,154,255,.15); }
    textarea { min-height: 120px; resize: vertical; }

    .controls { display:flex; flex-wrap:wrap; gap: 10px; }
    .select, .chip, .btn { display:inline-flex; align-items:center; gap:8px; border-radius: 14px; border:1px solid var(--panel-border); background: rgba(255,255,255,.06); padding:10px 12px; font-size: 14px; cursor: pointer; user-select:none; transition: transform .05s ease, background .2s, border-color .2s; }
    .chip:hover, .btn:hover, .select:hover { background: rgba(255,255,255,.12); }
    .btn:active { transform: translateY(1px) scale(.99); }
    .btn.primary { background: linear-gradient(135deg, color-mix(in oklab, var(--accent-1) 82%, white), color-mix(in oklab, var(--accent-2) 82%, white)); border: none; color: #111; font-weight: 800; box-shadow: 0 6px 16px rgba(124,154,255,.25); }

    select { appearance:none; background: transparent; color: inherit; border: none; font: inherit; outline: none; }

    /* ===== Style cards ===== */
    .styles { display:grid; grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); gap: 14px; }
    .style-card { position:relative; padding: 14px; border-radius: 16px; border:1px solid var(--panel-border); background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04)); min-height: 120px; display:flex; flex-direction:column; gap:10px; }
    .style-head { display:flex; align-items:center; justify-content: space-between; gap:8px; }
    .style-name { font-weight: 700; font-size: 14px; }
    .style-desc { color: var(--muted); font-size: 12px; }
    .out { font-size: clamp(18px, 2.2vw, 22px); line-height: 1.35; word-break: break-word; }
    .card-actions { display:flex; gap:8px; }

    .toast { position: fixed; left: 50%; bottom: 16px; transform: translateX(-50%) translateY(20px); opacity: 0; background: #111; color: #fff; padding: 10px 14px; border-radius: 999px; box-shadow: var(--shadow); transition: .25s ease; z-index: 99; }
    .toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }

    /* Footer / Help */
    details.help { margin-top: 18px; }
    details.help summary { list-style: none; cursor: pointer; }
    details.help summary::-webkit-details-marker{ display:none; }
    details.help .helpbox { margin-top: 10px; padding: 14px; border-radius: 14px; border:1px dashed var(--panel-border); background: rgba(255,255,255,.04);
      font-size: 14px; color: var(--muted); }
    .kbd{ font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; background: rgba(255,255,255,.08); border:1px solid var(--panel-border); padding:.2em .45em; border-radius:8px; }

    .footer { text-align:center; color: var(--muted); font-size: 12px; padding: 20px 8px; }
  </style>
</head>
<body>
  <div class="bg-grid" aria-hidden="true"></div>
  <div class="container">
    <div class="card header">
      <div class="logo" aria-hidden="true"><span>âœ§</span></div>
      <div>
        <div class="title">ãƒ•ã‚©ãƒ³ãƒˆå¤‰æ›ãƒ„ãƒ¼ãƒ«</div>
        <div class="subtitle">ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆã‚’ â€œã‹ã‚ã„ã„è¦‹ãŸç›®ã®æ–‡å­—â€ ã«ä¸€ç¬ã§å¤‰æ›ã—ã¦ã‚³ãƒ”ãƒš âœ¨</div>
      </div>
      <div style="margin-left:auto; display:flex; gap:8px; align-items:center;">
        <button class="btn" id="themeBtn" title="ãƒ†ãƒ¼ãƒåˆ‡æ›¿ (Light/Dark)">ğŸŒ— ãƒ†ãƒ¼ãƒ</button>
        <button class="btn" id="shareBtn" title="URLã‚’å…±æœ‰">ğŸ”— å…±æœ‰</button>
        <button class="btn primary" id="copyAllBtn" title="è¡¨ç¤ºä¸­ã®çµæœã‚’ã¾ã¨ã‚ã¦ã‚³ãƒ”ãƒ¼">ä¸€æ‹¬ã‚³ãƒ”ãƒ¼</button>
      </div>
    </div>

    <div class="grid">
      <!-- Left: Input & Options -->
      <div class="card section">
        <div class="label-row">
          <h3>å…¥åŠ›ãƒ†ã‚­ã‚¹ãƒˆ</h3>
          <div class="hint">è‹±å­—ï¼ˆAã€œZ / aã€œzï¼‰ã¨æ•°å­—ãŒã‹ã‚ã„ããªã‚Šã¾ã™ã€‚ã²ã‚‰ãŒãªç­‰ã¯ãã®ã¾ã¾ã€‚</div>
        </div>
        <textarea id="input" placeholder="ä¾‹ï¼‰Hello from shimarin"></textarea>

        <div style="height:10px"></div>

        <div class="label-row">
          <h3>ã‚ªãƒ—ã‚·ãƒ§ãƒ³</h3>
          <div class="hint">è¦‹ãŸç›®ã‚„ä»•ä¸Šã’ã‚’èª¿æ•´ã§ãã¾ã™</div>
        </div>
        <div class="controls" role="group" aria-label="å¤‰æ›ã‚ªãƒ—ã‚·ãƒ§ãƒ³">
          <div class="select">
            <span>ğŸ”¤ å¤§æ–‡å­—/å°æ–‡å­—</span>
            <select id="caseSelect" aria-label="å¤§æ–‡å­—å°æ–‡å­—ã®é¸æŠ">
              <option value="keep">ãã®ã¾ã¾</option>
              <option value="upper">ã™ã¹ã¦å¤§æ–‡å­—</option>
              <option value="lower">ã™ã¹ã¦å°æ–‡å­—</option>
            </select>
          </div>
          <div class="select">
            <span>âœ¨ ãƒ‡ã‚³</span>
            <select id="decoSelect" aria-label="ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç¨®é¡">
              <option value="none">ãªã—</option>
              <option value="heart">ãƒãƒ¼ãƒˆ â™¡</option>
              <option value="sparkle">ãã‚‰ãã‚‰ âœ¨</option>
              <option value="star">ã‚¹ã‚¿â€• â˜…</option>
              <option value="ribbon">ãƒªãƒœãƒ³ ğŸ€</option>
            </select>
          </div>
          <div class="select">
            <span>é…ç½®</span>
            <select id="decoMode" aria-label="ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³é…ç½®">
              <option value="edge">ä¸¡ã¯ã—</option>
              <option value="between">æ–‡å­—ã®é–“</option>
            </select>
          </div>
          <button class="btn" id="shuffleBtn" title="ã‚µãƒ³ãƒ—ãƒ«æ–‡ã‚’å…¥ã‚Œã‚‹">ğŸ² ã‚µãƒ³ãƒ—ãƒ«</button>
          <button class="btn" id="clearBtn" title="å…¥åŠ›ã‚’ç©ºã«ã™ã‚‹">ğŸ§¹ ã‚¯ãƒªã‚¢</button>
        </div>
      </div>

      <!-- Right: Result list -->
      <div class="card section">
        <div class="label-row">
          <h3>å¤‰æ›çµæœï¼ˆã‚¿ãƒƒãƒ—ã§ã‚³ãƒ”ãƒ¼ï¼‰</h3>
          <div class="hint">ç«¯æœ«ã«ã‚ˆã£ã¦ã¯è¦‹ãŸç›®ãŒå°‘ã—å¤‰ã‚ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™</div>
        </div>
        <div id="styles" class="styles" aria-live="polite"></div>

        <details class="help">
          <summary class="chip">ğŸ“ ä½¿ã„æ–¹ãƒ»ãƒ’ãƒ³ãƒˆï¼ˆã‚¯ãƒªãƒƒã‚¯ã§é–‹ãï¼‰</summary>
          <div class="helpbox">
            <p>1) ä¸Šã§æ–‡å­—ã‚’å…¥åŠ› â†’ 2) ä¸‹ã«è¡¨ç¤ºã•ã‚ŒãŸã‚¹ã‚¿ã‚¤ãƒ«ã‚’ã‚¿ãƒƒãƒ—ã—ã¦ã‚³ãƒ”ãƒ¼ â†’ 3) SNSã‚„ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã«è²¼ã‚Šä»˜ã‘ï¼</p>
            <p>è‹±å­—ã¯ <span class="kbd">Unicode</span> ã¨ã‚ˆã°ã‚Œã‚‹ç•ªå·ã§è¡¨ã•ã‚Œã¦ãŠã‚Šã€ç•ªå·ã®é•ã† â€œè¦‹ãŸç›®ã¡ãŒã„ã®ä»²é–“â€ ã«å·®ã—æ›¿ãˆã‚‹ä»•çµ„ã¿ã§ã™ã€‚æ–‡å­—ãã®ã‚‚ã®ãªã®ã§ã€ç”»åƒã§ã¯ãªãã‚³ãƒ”ãƒšã§ä½¿ãˆã¾ã™ã€‚</p>
            <ul>
              <li>ã‚³ãƒ”ãƒ¼ã«æˆåŠŸã™ã‚‹ã¨ã€ç”»é¢ä¸‹ã«ãƒˆãƒ¼ã‚¹ãƒˆãŒå‡ºã¾ã™ã€‚</li>
              <li>ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ãŸå ´åˆã¯ã€çµæœãƒ†ã‚­ã‚¹ãƒˆãŒ<strong>è‡ªå‹•ã§é¸æŠçŠ¶æ…‹</strong>ã«ãªã‚Šã¾ã™ã€‚<span class="kbd">Ctrl + C</span> / <span class="kbd">Cmd + C</span> ã§ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„ï¼ˆã‚¹ãƒãƒ›ã¯é•·æŠ¼ã—â†’ã‚³ãƒ”ãƒ¼ï¼‰ã€‚</li>
              <li>ãƒ–ãƒ©ã‚¦ã‚¶ã¯ <span class="kbd">https://</span> ã‹ <span class="kbd">http://localhost</span> ã§é–‹ãã¨å®‰å®šã—ã¾ã™ï¼ˆVS Code ã® <span class="kbd">Live Server</span> æ¨å¥¨ï¼‰ã€‚</li>
              <li>å…±æœ‰ãƒœã‚¿ãƒ³ã§ã€ä»Šã®ãƒ†ã‚­ã‚¹ãƒˆã‚’å«ã‚€URLã‚’ä½œã‚Œã¾ã™ã€‚</li>
              <li>ã‚¹ãƒãƒ›ã§è¦‹ãŸç›®ãŒå¤‰ã‚ã‚‹æ™‚ã¯ã€ãƒ•ã‚©ãƒ³ãƒˆã®å¯¾å¿œçŠ¶æ³ãŒåŸå› ã®ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚</li>
            </ul>
          </div>
        </details>
      </div>
    </div>

    <div class="footer">Â© 2025 Font Cute â€“ æ–‡å­—ã¯å¤‰èº«ã—ã¦ã‚‚å¿ƒã¯ãã®ã¾ã¾ (â€¢á´—â€¢)Ùˆ</div>
  </div>

  <div id="toast" class="toast" role="status" aria-live="polite">ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ</div>

  <script>
    // ========= Utilities =========
    const $ = (sel) => document.querySelector(sel);
    const inputEl = $('#input');
    const stylesEl = $('#styles');
    const toastEl = $('#toast');

    // ===== Copy helpers (secure + fallback) =====
    function safeCopyText(text){
      if (navigator.clipboard && window.isSecureContext){
        return navigator.clipboard.writeText(text);
      } else {
        try {
          const ta = document.createElement('textarea');
          ta.value = text; ta.setAttribute('readonly','');
          ta.style.position='fixed'; ta.style.top='-9999px';
          document.body.appendChild(ta); ta.select(); ta.setSelectionRange(0, ta.value.length);
          const ok = document.execCommand('copy');
          document.body.removeChild(ta);
          return ok ? Promise.resolve() : Promise.reject();
        } catch(e){ return Promise.reject(e); }
      }
    }
    function selectElementForCopy(el){
      try {
        const range = document.createRange(); range.selectNodeContents(el);
        const sel = window.getSelection(); sel.removeAllRanges(); sel.addRange(range);
      } catch(e){}
    }

    function showToast(msg = 'ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ'){
      toastEl.textContent = msg;
      toastEl.classList.add('show');
      setTimeout(() => toastEl.classList.remove('show'), 1200);
    }

    // Persist theme
    const prefersLight = window.matchMedia('(prefers-color-scheme: light)').matches;
    let theme = localStorage.getItem('theme') || (prefersLight ? 'light' : 'dark');
    function applyTheme(){ document.documentElement.style.colorScheme = theme; }
    applyTheme();
    $('#themeBtn').addEventListener('click', () => { theme = (theme === 'light') ? 'dark' : 'light'; localStorage.setItem('theme', theme); applyTheme(); });

    // ========= Text helpers =========
    const A = 'A'.charCodeAt(0), Z = 'Z'.charCodeAt(0);
    const a = 'a'.charCodeAt(0), z = 'z'.charCodeAt(0);
    const d0 = '0'.charCodeAt(0), d9 = '9'.charCodeAt(0);

    const circledDigits = {
      '0': '\u24EA', // â“ª
      '1': '\u2460','2': '\u2461','3': '\u2462','4': '\u2463','5': '\u2464','6': '\u2465','7': '\u2466','8': '\u2467','9': '\u2468'
    };

    function mapAlphaNum(ch, bases){
      const code = ch.codePointAt(0);
      if (code >= A && code <= Z && bases.upper != null) return String.fromCodePoint(bases.upper + (code - A));
      if (code >= a && code <= z && bases.lower != null) return String.fromCodePoint(bases.lower + (code - a));
      if (code >= d0 && code <= d9 && bases.digit != null) return String.fromCodePoint(bases.digit + (code - d0));
      if (bases.circledDigit && circledDigits[ch]) return circledDigits[ch];
      return ch; // keep as is
    }

    function mapString(str, bases){
      let out = '';
      for (const ch of str){ out += mapAlphaNum(ch, bases); }
      return out;
    }

    // ========= Style Definitions =========
    const STYLES = [
      {
        id: 'bubble',
        name: 'ã¾ã‚‹æ–‡å­— (Bubble)',
        desc: 'ã¾ã‚‹ã§ã‚¹ãƒ†ãƒƒã‚«ãƒ¼ã®ã‚ˆã†ãªå›²ã¿æ–‡å­—',
        transform: (s)=> mapString(s, { upper: 0x24B6, lower: 0x24D0, circledDigit: true })
      },
      {
        id: 'boldScript',
        name: 'ãµã‚æ–‡å­— (Bold Script)',
        desc: 'æ‰‹æ›¸ãé¢¨ã§ã‚„ã‚ã‚‰ã‹',
        transform: (s)=> mapString(s, { upper: 0x1D4D0, lower: 0x1D4EA })
      },
      {
        id: 'bold',
        name: 'ã¤ã‚ˆã‹ã‚ (Bold)',
        desc: 'å¤ªã‚ã§å­˜åœ¨æ„Ÿ',
        transform: (s)=> mapString(s, { upper: 0x1D400, lower: 0x1D41A, digit: 0x1D7CE })
      },
      {
        id: 'double',
        name: 'ãã‚‰ã‚ã (Double-struck)',
        desc: 'é»’æ¿ãƒãƒ§ãƒ¼ã‚¯é¢¨ã®äºŒé‡ç·š',
        transform: (s)=> mapString(s, { upper: 0x1D538, lower: 0x1D552, digit: 0x1D7D8 })
      },
      {
        id: 'sans',
        name: 'ã‚¹ãƒƒã‚­ãƒª (Sans-serif)',
        desc: 'ã‚„ã•ã—ã„ã‚µãƒ³ã‚»ãƒªãƒ•',
        transform: (s)=> mapString(s, { upper: 0x1D5A0, lower: 0x1D5BA, digit: 0x1D7E2 })
      },
      {
        id: 'mono',
        name: 'ã‚«ãƒãƒƒ (Monospace)',
        desc: 'ç­‰å¹…ã§ãƒ¬ãƒˆãƒ­ã‹ã‚ã„ã„',
        transform: (s)=> mapString(s, { upper: 0x1D670, lower: 0x1D68A, digit: 0x1D7F6 })
      },
      {
        id: 'fraktur',
        name: 'ã‚´ã‚·ã‹ã‚ (Fraktur)',
        desc: 'ã‚¯ãƒ©ã‚·ãƒƒã‚¯ãªé›°å›²æ°—',
        transform: (s)=> mapString(s, { upper: 0x1D504, lower: 0x1D51E })
      },
      {
        id: 'fullwidth',
        name: 'ãµã¨ã¾ã‚‹ (å…¨è§’)',
        desc: 'å…¨è§’ã§ãƒãƒƒãƒ—',
        transform: (s)=> mapString(s, { upper: 0xFF21, lower: 0xFF41, digit: 0xFF10 })
      }
    ];

    const DECOS = { none: '', heart: 'â™¡', sparkle: 'âœ¨', star: 'â˜…', ribbon: 'ğŸ€' };

    function applyDeco(text, deco, mode){
      const d = DECOS[deco] || '';
      if (!d) return text;
      if (mode === 'between'){
        // Insert between letters but keep spaces/newlines as is
        let out = '';
        for (let i=0; i<text.length; i++){
          const ch = text[i];
          out += ch;
          const next = text[i+1];
          if (next && ch !== '\n' && next !== '\n' && ch !== ' ' && next !== ' '){ out += d; }
        }
        return out;
      }
      return `${d} ${text} ${d}`;
    }

    function normalizeCase(text, mode){
      if (mode === 'upper') return text.toUpperCase();
      if (mode === 'lower') return text.toLowerCase();
      return text;
    }

    function render(){
      const raw = inputEl.value || '';
      const cMode = $('#caseSelect').value;
      const deco = $('#decoSelect').value;
      const decoMode = $('#decoMode').value;
      const src = normalizeCase(raw, cMode);
      stylesEl.innerHTML = '';
      STYLES.forEach(style => {
        let t = style.transform(src);
        t = applyDeco(t, deco, decoMode);
        const card = document.createElement('div'); card.className = 'style-card';
        card.innerHTML = `
          <div class="style-head">
            <div>
              <div class="style-name">${style.name}</div>
              <div class="style-desc">${style.desc}</div>
            </div>
            <div class="card-actions">
              <button class="btn" data-copy>ğŸ“‹ ã‚³ãƒ”ãƒ¼</button>
            </div>
          </div>
          <div class="out" data-out>${t || '<span style="color:var(--muted)">ï¼ˆã“ã“ã«çµæœãŒè¡¨ç¤ºã•ã‚Œã¾ã™ï¼‰</span>'}</div>
        `;
        card.addEventListener('click', (e)=>{
          if (e.target.matches('[data-copy]') || e.target.closest('[data-out]')){
            const txt = card.querySelector('[data-out]').innerText;
            safeCopyText(txt).then(()=> showToast('ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ')).catch(()=> { selectElementForCopy(card.querySelector('[data-out]')); showToast('é¸æŠã—ã¾ã—ãŸã€‚Ctrl/Cmd+C ã§ã‚³ãƒ”ãƒ¼'); });
          }
        });
        stylesEl.appendChild(card);
      });
      // update share URL (shallow)
      const url = new URL(location);
      if (raw) url.searchParams.set('text', raw); else url.searchParams.delete('text');
      history.replaceState({}, '', url);
      localStorage.setItem('fontcute:last', raw);
    }

    // Debounce input
    let tId; inputEl.addEventListener('input', ()=>{ clearTimeout(tId); tId = setTimeout(render, 10); });

    // Buttons
    $('#clearBtn').addEventListener('click', ()=>{ inputEl.value=''; render(); inputEl.focus(); });
    $('#shuffleBtn').addEventListener('click', ()=>{
      const samples = [
        'Hello from shimarin', 'Cutest Letters', 'Kawaii Vibes', 'Coffee & Coding', 'Stay comfy, stay kind', 'Dream big, start small', 'Cute text generator', 'Follow your color', 'Happy Friday!', 'Love & peace'
      ];
      inputEl.value = samples[Math.floor(Math.random()*samples.length)];
      render();
    });
    $('#copyAllBtn').addEventListener('click', ()=>{
      const outs = [...document.querySelectorAll('[data-out]')].map(e=> e.innerText).filter(Boolean);
      const txt = outs.join('\n');
      if (!txt.trim()) return showToast('ã‚³ãƒ”ãƒ¼ã™ã‚‹å†…å®¹ãŒã‚ã‚Šã¾ã›ã‚“');
      safeCopyText(txt).then(()=> showToast('å…¨éƒ¨ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ')).catch(()=> { const ta=document.createElement('textarea'); ta.value=txt; document.body.appendChild(ta); ta.select(); showToast('é¸æŠã—ã¾ã—ãŸã€‚Ctrl/Cmd+C ã§ã‚³ãƒ”ãƒ¼'); setTimeout(()=>{ try{document.body.removeChild(ta);}catch(e){} }, 1200); });
    });

    $('#shareBtn').addEventListener('click', ()=>{
      const url = location.href;
      if (navigator.share){ navigator.share({ title: 'ãƒ•ã‚©ãƒ³ãƒˆå¤‰æ›ãƒ„ãƒ¼ãƒ«', url }).catch(()=>{}); }
      else { safeCopyText(url).then(()=> showToast('URLã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ')).catch(()=> { try{ window.prompt('ã“ã®URLã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„', url); }catch(e){} }); }
    });

    // On load: restore from URL or localStorage
    (function init(){
      const params = new URLSearchParams(location.search);
      const text = params.get('text') || localStorage.getItem('fontcute:last') || '';
      inputEl.value = text;
      render();
    })();
  </script>
</body>
</html>
